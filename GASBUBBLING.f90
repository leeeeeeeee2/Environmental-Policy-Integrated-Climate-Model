      SUBROUTINE GASBUBBLING(QO2BUB,QCO2BUB,QN2OBUB,QN2BUB,CLO2,CLCO2,CLN2O,CLN2,T,VWC,DZ)
      REAL, INTENT(OUT)::QO2BUB,QCO2BUB,QN2OBUB,QN2BUB
      REAL, INTENT(IN)::CLO2,CLCO2,CLN2O,CLN2,T,VWC,DZ
      P=101.325
      R=8.3143
      O2M=32.
      CO2M=44.
      XN2OM=42.
      XN2M=28. !should we adjust atmospheric pressure according to elevation?
      TEMP=T+273. !K
      GASAQO2=CLO2/O2M !mol m-3
      GASAQCO2=CLCO2/CO2M !mol m-3
      GASAQN2O=CLN2O/XN2OM !mol m-3
      GASAQN2=CLN2/XN2M !mol m-3
      GASAQALL=GASAQO2+GASAQCO2+GASAQN2O+GASAQN2  !mol m-3
      X1=GASAQALL-P/(R*TEMP) !mol m-3
      X1=MAX(0.,X1)
      X2=10.*VWC*DZ !m3 1000 g kg-1
      QO2BUB=X1*(GASAQO2/GASAQALL)*O2M*X2 !kg O2 ha-1
      QCO2BUB=X1*(GASAQCO2/GASAQALL)*CO2M*X2 !kg CO2 ha-1
      QN2OBUB=X1*(GASAQN2O/GASAQALL)*XN2OM*X2 !kg N2O ha-1
      QN2BUB=X1*(GASAQN2/GASAQALL)*XN2M*X2 !kg N2 ha-1
      END SUBROUTINE GasBubbling